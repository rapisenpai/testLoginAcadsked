document.addEventListener('DOMContentLoaded',function(){function validateTextInput(input){const helper=document.getElementById(`${input.id}-helper`);if(input.value.trim()===""){input.classList.add('border-red-500','focus:border-red-500','focus:ring-red-500');input.classList.remove('border-gray-200','focus:border-primary-500','focus:ring-primary-500');helper.textContent="This field is required.";}else{input.classList.remove('border-red-500','focus:border-red-500','focus:ring-red-500');input.classList.add('border-gray-200','focus:border-primary-500','focus:ring-primary-500');helper.textContent="";}}
function validateSelectInput(select){const helper=document.getElementById(`${select.id}-helper`);if(select.value===""||select.value==="Select Institute"){select.classList.add('border-red-500','focus:border-red-500','focus:ring-red-500');select.classList.remove('border-gray-200','focus:border-primary-500','focus:ring-primary-500');helper.textContent="Please select an institute.";}else{select.classList.remove('border-red-500','focus:border-red-500','focus:ring-red-500');select.classList.add('border-gray-200','focus:border-primary-500','focus:ring-primary-500');helper.textContent="";}}
function toSentenceCase(str){str=str.replace(/_/g,' ');return str.charAt(0).toUpperCase()+str.slice(1).toLowerCase();}
function checkUnique(field,value,helper){fetch(`curriculum/check-unique/?field=${field}&value=${value}`,{credentials:'same-origin',headers:{'X-CSRFToken':getCookie('csrftoken')}}).then(response=>response.json()).then(data=>{if(data.exists){helper.textContent=`${toSentenceCase(field)} already exists.`;input.classList.add('border-red-500','focus:border-red-500','focus:ring-red-500');input.classList.remove('border-gray-200','focus:border-primary-500','focus:ring-primary-500');}else{helper.textContent="";document.getElementById(field).classList.remove('border-red-500','focus:border-red-500','focus:ring-red-500');document.getElementById(field).classList.add('border-gray-200','focus:border-primary-500','focus:ring-primary-500');}});}
function getCookie(name){let cookieValue=null;if(document.cookie&&document.cookie!==''){const cookies=document.cookie.split(';');for(let i=0;i<cookies.length;i++){const cookie=cookies[i].trim();if(cookie.substring(0,name.length+1)===(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}
return cookieValue;}
function attachValidation(){document.getElementById('add-program-name').addEventListener('input',function(){validateTextInput(this);if(this.value.trim()!==""){const helper=document.getElementById(`${this.id}-helper`);checkUnique('program_name',this.value,helper);}});document.getElementById('add-program-code').addEventListener('input',function(){validateTextInput(this);if(this.value.trim()!==""){const helper=document.getElementById(`${this.id}-helper`);checkUnique('program_code',this.value,helper);}});document.getElementById('add-program-institute').addEventListener('change',function(){validateSelectInput(this);});}
attachValidation();});;